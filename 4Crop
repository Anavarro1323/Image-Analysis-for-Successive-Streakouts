%4 Crop*



radius = 570;
basefolder = 'C:\Users\aleja\OneDrive\Desktop\SenSeekInput\[B2]C7 AT1\'
InputFolder = strcat(basefolder,'Input\')
MidputFolder = strcat(basefolder,'Midput\')


filePattern = fullfile(InputFolder, '*.jpg');
theFiles = dir(filePattern);
SE = offsetstrel('ball',100,5);

% User Inputs
Gens = 5

% 
%  for K = [1:Gens]
% batch = "[B2]C7 AT1 "
% Genk = strcat('Gen',string(K),'.jpg') 
% 
% InputImages(K).photos = imread(fullfile(InputFolder,strcat(string(batch), string(Genk))))
% imshow(InputImages(K).photos)
% h = datacursormode
% pause(5)
% InputImages(K).centers = getCursorInfo(h)
% close all
% end
% 




%PreProcess 
for K = [1:length(theFiles)] 
 
 PitriDish = images.roi.Circle(gca,'Center',[InputImages(K).centers.Position(1) InputImages(K).centers.Position(2)],'Radius',radius);
 Mask = double(PitriDish.createMask(InputImages(K).photos));
 masked = bsxfun(@times, InputImages(K).photos, cast(Mask, 'like', InputImages(K).photos));
 
 %Loads image into workspace
[Height, Width,trash] = size(masked);
 
%Optional chunk: shows the crop cut positions. 
%Change where the crop is with Cx and Cy up above
 
Cx = InputImages(K).centers.Position(1)
Cy = InputImages(K).centers.Position(2)
xsmall = minus(Cx,radius)
xlarge = plus(Cx,radius)
ysmall = minus(Cy,radius)
ylarge = plus(Cy,radius)

Q1 = imcrop(masked,[xsmall ysmall radius radius]);
Q2 = imcrop(masked,[Cx ysmall radius radius]);
Q3 = imcrop(masked,[xsmall Cy radius radius]);
Q4 = imcrop(masked,[Cx Cy radius radius]);

MidputImages(K).First = Q1
imshow(Q1);
saveas(gcf,[MidputFolder,'Q1_',theFiles(K).name])

MidputImages(K).Second = Q2
imshow(Q2);
saveas(gcf,[MidputFolder,'Q2_',theFiles(K).name])

MidputImages(K).Third = Q3
imshow(Q3);
saveas(gcf,[MidputFolder,'Q3_',theFiles(K).name])

MidputImages(K).Fourth = Q4
imshow(Q4);
saveas(gcf,[MidputFolder,'Q4_',theFiles(K).name])

end

save('4CropWorkspace')
movefile('4CropWorkspace.mat',basefolder)
